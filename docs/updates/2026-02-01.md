# 2026-02-01 æ›´æ–°å±¥æ­´

## Wikipediaé¢¨ã®å¤‰æ•°ã‚½ãƒ¼ã‚¹å‚ç…§è¡¨ç¤ºæ©Ÿèƒ½

### æ¦‚è¦
ãƒšãƒ¼ã‚¸å†…ã§ä½¿ç”¨ã—ã¦ã„ã‚‹å¤‰æ•°ï¼ˆ`{{variable_name}}`ï¼‰ã®ã‚½ãƒ¼ã‚¹URLã‚’Wikipediaé¢¨ã«å‚ç…§è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚

### å¤‰æ›´å†…å®¹

#### 1. å¤‰æ•°ç½®æ›æ©Ÿèƒ½ã®æ‹¡å¼µ (`lib/template/replace.ts`)
- `replaceVariablesWithSources()` é–¢æ•°ã‚’è¿½åŠ 
- å¤‰æ•°ç½®æ›æ™‚ã«ã€ä½¿ç”¨ã—ãŸå¤‰æ•°ã®ã‚½ãƒ¼ã‚¹æƒ…å ±ï¼ˆsourceUrl, confidence, sourceï¼‰ã‚’åé›†
- `VariableSourceInfo` å‹ã¨ `ReplaceResultWithSources` å‹ã‚’è¿½åŠ 

#### 2. Artifactèª­ã¿è¾¼ã¿æ™‚ã®ã‚½ãƒ¼ã‚¹æƒ…å ±ç”Ÿæˆ (`lib/artifact/loader.ts`)
- `loadArtifactInternal()` ã§å¤‰æ•°ç½®æ›æ™‚ã«ã‚½ãƒ¼ã‚¹æƒ…å ±ã‚’åé›†
- `buildSourcesFromVariables()` é–¢æ•°ã§ã‚½ãƒ¼ã‚¹æƒ…å ±ã‚’Sourceé…åˆ—ã«å¤‰æ›
- åŒã˜URLã‹ã‚‰ã®å¤‰æ•°ã¯ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
- ArtifactLoadResultã« `sources: Source[]` ã‚’è¿½åŠ 

#### 3. ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ›´æ–° (`app/[municipality]/[[...path]]/page.tsx`)
- loadArtifactã®çµæœã‹ã‚‰ç›´æ¥sourcesã‚’å–å¾—
- BlockRendererã«sourcesã‚’æ¸¡ã™

#### 4. Sourcesãƒ–ãƒ­ãƒƒã‚¯ã®è¿½åŠ 
ä»¥ä¸‹ã®å…¨ã¦ã®JSONãƒ•ã‚¡ã‚¤ãƒ«ã«Sourcesãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ :
- `_templates/` é…ä¸‹ã®122ãƒ•ã‚¡ã‚¤ãƒ«
- `sample/` é…ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«
- `takaoka/` é…ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«
- åˆè¨ˆ 366ãƒ•ã‚¡ã‚¤ãƒ«

### å‹•ä½œ
1. ãƒšãƒ¼ã‚¸ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã¨ã€å¤‰æ•°ã‚¹ãƒˆã‚¢ã‹ã‚‰å¤‰æ•°å€¤ã¨å…±ã«ã‚½ãƒ¼ã‚¹URLã‚’å–å¾—
2. ä½¿ç”¨ã•ã‚ŒãŸå¤‰æ•°ã®ã‚½ãƒ¼ã‚¹URLã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¦Sourceé…åˆ—ã‚’ç”Ÿæˆ
3. ãƒšãƒ¼ã‚¸ä¸‹éƒ¨ã®ã€Œæƒ…å ±ã®å‡ºå…¸ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚½ãƒ¼ã‚¹ä¸€è¦§ã‚’è¡¨ç¤º
4. å„ã‚½ãƒ¼ã‚¹ã«ã¯å‚ç…§ç•ªå·[1], [2]...ãŒä»˜ä¸ã•ã‚Œã€ã‚¢ã‚¯ã‚»ã‚¹æ—¥æ™‚ã‚‚è¡¨ç¤º

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/lib/template/replace.ts` - å¤‰æ•°ç½®æ›ã¨ã‚½ãƒ¼ã‚¹æƒ…å ±åé›†
- `apps/web/lib/template/index.ts` - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ 
- `apps/web/lib/artifact/loader.ts` - ã‚½ãƒ¼ã‚¹æƒ…å ±ã®Artifactçµ±åˆ
- `apps/web/app/[municipality]/[[...path]]/page.tsx` - ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- `apps/web/components/blocks/components/SourcesBlocks.tsx` - UIè¡¨ç¤ºï¼ˆæ—¢å­˜ï¼‰

## è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒœãƒƒãƒˆ v2ï¼ˆClaude Codeçµ±åˆç‰ˆï¼‰

### æ¦‚è¦
CLAUDE.mdã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒ«ã‚’ç†è§£ã—ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ã®æ¤œè¨¼ãƒ»æœ€é©åŒ–ã‚’è‡ªå‹•ã§è¡Œã†ãƒœãƒƒãƒˆã‚’å®Ÿè£…ã€‚v2ã§ã¯é«˜åº¦ãªåˆ†ææ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€æ—¥æœ¬èªã®èª­ã¿ã‚„ã™ã•ã€èªçŸ¥æ§‹é€ ã®ä¸€è‡´ã€è¡Œæ”¿ç”¨èªã®é©åˆ‡æ€§ãªã©ã‚’æ¤œæŸ»å¯èƒ½ã€‚

### ä¸»è¦æ©Ÿèƒ½

#### 1. åŸºæœ¬æ¤œè¨¼ï¼ˆvalidateï¼‰
- `schema_version`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å­˜åœ¨ç¢ºèª
- Tableãƒ–ãƒ­ãƒƒã‚¯ã®ç©ºvalueæ¤œå‡º
- æ‰‹é †ãƒªã‚¹ãƒˆï¼ˆ3ã‚¹ãƒ†ãƒƒãƒ—ä»¥ä¸Šï¼‰ã®StepNavigationå€™è£œæ¤œå‡º
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³é †åºãƒã‚§ãƒƒã‚¯ï¼ˆCOMPONENT_SELECTION_LOGIC.mdæº–æ‹ ï¼‰
- æœªå®šç¾©å¤‰æ•°ã®æ¤œå‡º

#### 2. æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆåˆ†æï¼ˆreadabilityï¼‰
- æ–‡ã®é•·ã•ï¼ˆ50æ–‡å­—è¶…ã§è­¦å‘Šï¼‰
- å—å‹•æ…‹ã®ä½¿ç”¨æ¤œå‡ºï¼ˆã€Œã‚Œã‚‹ã€ã€Œã‚‰ã‚Œã‚‹ã€ï¼‰
- äºŒé‡å¦å®šã®æ¤œå‡º
- é•·æ–‡ã®æ®µè½æ¤œå‡º

#### 3. è¡Œæ”¿ç”¨èªãƒã‚§ãƒƒã‚¯ï¼ˆterminologyï¼‰
30ä»¥ä¸Šã®é›£è§£ãªè¡Œæ”¿ç”¨èªã‚’è¾æ›¸åŒ–:
- ä¾‹ï¼šã€Œä½æ°‘ç¥¨ã®å†™ã—ã€â†’ã€Œä½æ‰€ã‚„ä¸–å¸¯æ§‹æˆã‚’è¨¼æ˜ã™ã‚‹å…¬çš„ãªæ›¸é¡ã€
- ç”¨èªã®èª¬æ˜ãŒãƒšãƒ¼ã‚¸å†…ã«ã‚ã‚‹ã‹ç¢ºèª
- èª¬æ˜ãŒãªã„å ´åˆã¯è¿½åŠ ã‚’ææ¡ˆ

#### 4. ç”³è«‹æƒ…å ±ã®å®Œå…¨æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆcompletenessï¼‰
- å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ¦‚è¦ã€å¯¾è±¡è€…ã€ç”³è«‹æ–¹æ³•ã€å¿…è¦æ›¸é¡ç­‰ï¼‰ã®æœ‰ç„¡
- ç”³è«‹å¯èƒ½ãªã‚µãƒ¼ãƒ“ã‚¹ã®ç”³è«‹æ–¹æ³•è¨˜è¼‰ç¢ºèª
- çª“å£æƒ…å ±ã®æœ‰ç„¡

#### 5. å¤–éƒ¨é›»å­ç”³è«‹ã‚µã‚¤ãƒˆã®ãƒªãƒ³ã‚¯ãƒã‚§ãƒƒã‚¯
å¯¾å¿œã‚µã‚¤ãƒˆ:
- e-Govï¼ˆé›»å­æ”¿åºœã®ç·åˆçª“å£ï¼‰
- ãƒã‚¤ãƒŠãƒãƒ¼ã‚¿ãƒ«
- eLTAXï¼ˆåœ°æ–¹ç¨ãƒãƒ¼ã‚¿ãƒ«ï¼‰
- gBizID
ãƒ˜ãƒ«ãƒ—ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯æœ‰ç„¡ã‚’ç¢ºèª

#### 6. èªçŸ¥æ§‹é€ ã®ä¸€è‡´ç¢ºèªï¼ˆcognitiveï¼‰
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³é †åºãŒè«–ç†çš„ã‹
- è¦‹å‡ºã—ã®å…·ä½“æ€§ï¼ˆã€Œãã®ä»–ã€ç­‰ã®æ›–æ˜§ãªè¡¨ç¾ã‚’æ¤œå‡ºï¼‰
- è¦‹å‡ºã—ã®éšå±¤æ§‹é€ ã®ä¸€è²«æ€§

#### 7. UIæ¤œæŸ»æ©Ÿèƒ½ï¼ˆPlaywrightï¼‰
- `analyze`: ãƒšãƒ¼ã‚¸ã‚’å·¡å›ã—ã¦ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼‹åˆ†æ
- `review`: å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§ãƒšãƒ¼ã‚¸ã‚’ç¢ºèªã—ãªãŒã‚‰èª¿æ•´
- `report`: å…¨ãƒšãƒ¼ã‚¸ã®å“è³ªãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

#### 8. ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ä½œæˆï¼ˆcreateï¼‰
- ãƒˆãƒ”ãƒƒã‚¯åã‚’æŒ‡å®šã—ã¦æ–°è¦ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ã‚’ç”Ÿæˆ
- ã‚¹ã‚­ãƒ¼ãƒæº–æ‹ ã®JSONæ§‹é€ ã‚’è‡ªå‹•ç”Ÿæˆ
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•°ã‚’é©åˆ‡ã«é…ç½®

#### 9. è‡ªå‹•æ”¹å–„ï¼ˆimproveï¼‰
- æ¤œå‡ºã—ãŸå•é¡Œã‚’è‡ªå‹•ä¿®æ­£
- `--auto-fix`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œ

### ä½¿ç”¨æ–¹æ³•
```bash
cd apps/web

# åŸºæœ¬æ¤œè¨¼
npm run bot:validate

# å…¨æ©Ÿèƒ½å®Ÿè¡Œ
npm run bot:all

# åˆ†æï¼ˆè¦: npm run devï¼‰
npm run bot:analyze

# ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆè¦: npm run devï¼‰
npm run bot:report

# æ–°è¦ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ä½œæˆ
npm run bot:create -- "ç”Ÿæ´»ä¿è­·"

# å¯¾è©±çš„ãƒ¬ãƒ“ãƒ¥ãƒ¼
npm run bot:review

# è‡ªå‹•æ”¹å–„
npm run bot:improve

# ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
npm run bot -- --help
```

### npmã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `npm run bot` | åŸºæœ¬å®Ÿè¡Œ |
| `npm run bot:all` | å…¨æ©Ÿèƒ½å®Ÿè¡Œ |
| `npm run bot:validate` | åŸºæœ¬æ¤œè¨¼ |
| `npm run bot:analyze` | AIåˆ†æï¼ˆheadedï¼‰ |
| `npm run bot:create` | ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ä½œæˆ |
| `npm run bot:improve` | è‡ªå‹•æ”¹å–„ |
| `npm run bot:review` | å¯¾è©±çš„ãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| `npm run bot:report` | ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ |

### ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
å„ãƒšãƒ¼ã‚¸ã«å¯¾ã—ã¦ä»¥ä¸‹ã®5ã‚«ãƒ†ã‚´ãƒªã§0-100ç‚¹ã®ã‚¹ã‚³ã‚¢ã‚’ç®—å‡º:
- **readability**: èª­ã¿ã‚„ã™ã•
- **usability**: æ“ä½œã—ã‚„ã™ã•
- **completeness**: æƒ…å ±ã®å®Œå…¨æ€§
- **terminology**: ç”¨èªã®é©åˆ‡ã•
- **cognitiveMatch**: èªçŸ¥æ§‹é€ ã®ä¸€è‡´

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/scripts/auto-update-bot.ts` - ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆv2ï¼‰
- `apps/web/package.json` - npmã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- `docs/COMPONENT_SELECTION_LOGIC.md` - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé¸æŠãƒ«ãƒ¼ãƒ«

### ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- `playwright` - ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–
- `@playwright/test` - Playwrightå‹å®šç¾©

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦‹å‡ºã—ã®æ–‡è„ˆå¯¾å¿œã¨ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã®å¤‰æ•°åŒ–

### æ¦‚è¦
ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦‹å‡ºã—ã‚’æ–‡è„ˆã«å¿œã˜ãŸå½¢å¼ã«å¤‰æ›´ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å¤‰æ•°åŒ–ã—ã¦ç®¡ç†å¯èƒ½ã«ã—ãŸã€‚

### å¤‰æ›´å†…å®¹

#### 1. è¦‹å‡ºã—ã®æ–‡è„ˆå¯¾å¿œ
- ã€Œå¯¾è±¡ã¨ãªã‚‹æ–¹ã€â†’ã€Œâ—‹â—‹å±Šã®å¯¾è±¡ã¨ãªã‚‹æ–¹ã€
- ã€Œæ‰‹ç¶šãæ–¹æ³•ã€â†’ã€Œâ—‹â—‹å±Šã®æ‰‹ç¶šãæ–¹æ³•ã€
- ã€Œç”³è«‹ã®æµã‚Œã€â†’ã€Œâ—‹â—‹å±Šã®ç”³è«‹ã®æµã‚Œã€
- `extractProcedureName()` é–¢æ•°ã‚’è¿½åŠ ã—ã¦æ‰‹ç¶šãåã‚’æŠ½å‡º
- `{procedure}` ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ãŸè¦‹å‡ºã—ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

#### 2. ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã®å¤‰æ•°åŒ–
å¤‰æ›å‰ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ï¼‰:
```json
{
  "text": "è©³ç´°ã¯æ‹…å½“èª²ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚"
}
```

å¤‰æ›å¾Œï¼ˆå¤‰æ•°å‚ç…§ï¼‰:
```json
{
  "text": "{{shussei_nagare}}"
}
```

#### 3. å¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®çµ±åˆ
- 91å€‹ã® `services_*.json` ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
- æ—¢å­˜ã®19ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã«çµ±åˆ
- 242å€‹ã®ã‚µãƒ¼ãƒ“ã‚¹å›ºæœ‰å¤‰æ•°ã‚’è¿½åŠ 

å¤‰æ•°ã®ç¨®é¡:
- `{service}_taisho` - å¯¾è±¡ã¨ãªã‚‹æ–¹ã®æƒ…å ±
- `{service}_hitsuyou` - å¿…è¦ãªã‚‚ã®ã®æƒ…å ±
- `{service}_houhou` - æ‰‹ç¶šãæ–¹æ³•ã®æƒ…å ±
- `{service}_nagare` - ç”³è«‹ã®æµã‚Œã®æƒ…å ±

#### 4. å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
- **artifacts**: 93ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆtakaokaï¼‰+ 77ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆsampleï¼‰= 170ãƒ•ã‚¡ã‚¤ãƒ«
- **variables**: 19ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ•°è¿½åŠ 
  - `registration.json` - å‡ºç”Ÿã€æ­»äº¡ã€å©šå§»ã€æˆ¸ç±ã€ä½æ°‘ç¥¨ã€å°é‘‘ã€è»¢å±…ç­‰
  - `childcare.json` - å…ç«¥æ‰‹å½“ã€ä¿è‚²æ‰€ã€æ¯å­ä¿å¥
  - `health.json` - å›½ä¿ã€å¾ŒæœŸé«˜é½¢ã€å¥è¨ºã€äºˆé˜²æ¥ç¨®
  - `tax.json` - ä½æ°‘ç¨ã€å›ºå®šè³‡ç”£ç¨ã€è»½è‡ªå‹•è»Šç¨ã€ãµã‚‹ã•ã¨ç´ç¨ç­‰
  - `welfare.json` - ä»‹è­·ã€åŒ…æ‹¬ã€ç”Ÿæ´»ä¿è­·ã€éšœãŒã„
  - ãã®ä»–14ã‚«ãƒ†ã‚´ãƒª

### ä»Šå¾Œã®å¯¾å¿œ
å¤‰æ•°ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å€¤ï¼ˆã€Œã€å¿…è¦ãªã‚‚ã®ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‘ã€ç­‰ï¼‰ã¯ã€LLMã‚„Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã§å®Ÿéš›ã®æƒ…å ±ã‚’å–å¾—ã—ã¦æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/scripts/auto-update-bot.ts` - è¦‹å‡ºã—ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¿½åŠ 
- `apps/web/data/artifacts/takaoka/variables/*.json` - å¤‰æ•°å®šç¾©
- `apps/web/data/artifacts/takaoka/services/**/*.json` - æ›´æ–°ã•ã‚ŒãŸartifacts

## ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å¤‰æ•°ã®LLMåŸ‹ã‚è¾¼ã¿

### æ¦‚è¦
å¤‰æ•°åŒ–ã•ã‚ŒãŸãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼ˆ`ã€å¿…è¦ãªã‚‚ã®ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‘`ç­‰ï¼‰ã‚’ã€ä¸€èˆ¬çš„ãªè¡Œæ”¿ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±ã«åŸºã¥ã„ã¦å®Ÿéš›ã®å€¤ã§ç½®ãæ›ãˆãŸã€‚

### å¤‰æ›´å†…å®¹

#### 1. auto-update-botã¸ã®populateã‚³ãƒãƒ³ãƒ‰è¿½åŠ 
- `npm run bot:populate` ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ 
- Anthropic APIã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å¤‰æ•°ã‚’åŸ‹ã‚ã‚‹æ©Ÿèƒ½
- å¤‰æ•°åã‹ã‚‰ã‚µãƒ¼ãƒ“ã‚¹åã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥ã‚’æ¨æ¸¬ã—ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ

#### 2. å¤‰æ•°å€¤ã®åŸ‹ã‚è¾¼ã¿
242ä»¶ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å¤‰æ•°ã‚’å®Ÿéš›ã®å€¤ã§æ›´æ–°:

| ã‚«ãƒ†ã‚´ãƒª | æ›´æ–°ä»¶æ•° | ä¾‹ |
|---------|---------|-----|
| registration | 21ä»¶ | å‡ºç”Ÿå±Šã€æ­»äº¡å±Šã€å©šå§»å±Šã€ä½æ°‘ç¥¨ã€å°é‘‘ç™»éŒ²ç­‰ |
| health | 9ä»¶ | å¥è¨ºã€äºˆé˜²æ¥ç¨®ã€å›½ä¿ã€å¾ŒæœŸé«˜é½¢ |
| childcare | 6ä»¶ | å…ç«¥æ‰‹å½“ã€ä¿è‚²æ‰€ç”³è«‹ã€æ¯å­ä¿å¥ |
| tax | 14ä»¶ | ä½æ°‘ç¨ã€å›ºå®šè³‡ç”£ç¨ã€ãµã‚‹ã•ã¨ç´ç¨ã€ç¢ºå®šç”³å‘Šç­‰ |
| welfare | 15ä»¶ | ä»‹è­·ä¿é™ºã€ç”Ÿæ´»ä¿è­·ã€éšœãŒã„ç¦ç¥‰ç­‰ |
| ãã®ä»– | 177ä»¶ | é‹è»¢å…è¨±ã€é›‡ç”¨ã€ä½å®…ã€åœŸåœ°ã€äº‹æ¥­è€…å‘ã‘ç­‰ |

#### 3. å¤‰æ•°ã®å€¤ä¾‹

```json
{
  "shussei_nagare": {
    "value": "1. ç—…é™¢ã§å‡ºç”Ÿè¨¼æ˜æ›¸ä»˜ãã®å‡ºç”Ÿå±Šã‚’å—ã‘å–ã‚‹ â†’ 2. å±Šå‡ºäººæ¬„ã‚’è¨˜å…¥ â†’ 3. çª“å£ã§å±Šå‡º â†’ 4. æ¯å­å¥åº·æ‰‹å¸³ã«å‡ºç”Ÿå±Šå‡ºæ¸ˆè¨¼æ˜ã‚’å—ã‘ã‚‹",
    "source": "llm",
    "confidence": 0.85,
    "updatedAt": "2026-02-01T05:09:26.495Z"
  },
  "juminhyo_houhou": {
    "value": "çª“å£ã§ã®ç”³è«‹ã®ã»ã‹ã€ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’ãŠæŒã¡ã®æ–¹ã¯ã‚³ãƒ³ãƒ“ãƒ‹äº¤ä»˜ã‚µãƒ¼ãƒ“ã‚¹ã‚‚åˆ©ç”¨å¯èƒ½",
    "source": "llm",
    "confidence": 0.85,
    "updatedAt": "2026-02-01T05:09:26.495Z"
  }
}
```

### å¤‰æ•°çµ±è¨ˆ
- ç·å¤‰æ•°æ•°: 650ä»¶
- LLMç”Ÿæˆ: 645ä»¶
- ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼æ®‹ã‚Š: 0ä»¶

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/scripts/auto-update-bot.ts` - populateã‚³ãƒãƒ³ãƒ‰è¿½åŠ 
- `apps/web/package.json` - `bot:populate` ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 
- `apps/web/data/artifacts/takaoka/variables/*.json` - æ›´æ–°ã•ã‚ŒãŸå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«

## ç”¨èªèª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å°‚é–€æ€§ãƒ¬ãƒ™ãƒ«å¯¾å¿œ

### æ¦‚è¦
ã€Œæœ¬äººç¢ºèªæ›¸é¡ã€ã€Œçµ¦ä»˜ã€ãªã©ã®ä¸€èˆ¬çš„ãªç”¨èªã¾ã§èª¬æ˜ã—ã¦ã„ãŸå•é¡Œã‚’ä¿®æ­£ã€‚å°‚é–€æ€§ã®é«˜ã„ç”¨èªã®ã¿ã‚’èª¬æ˜å¯¾è±¡ã¨ã™ã‚‹ã‚ˆã†ã«ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ”¹å–„ã€‚

### å¤‰æ›´å†…å®¹

#### 1. ç”¨èªã®å°‚é–€æ€§ãƒ¬ãƒ™ãƒ«åˆ†é¡
ç”¨èªã‚’3æ®µéšã®ãƒ¬ãƒ™ãƒ«ã«åˆ†é¡:

**HIGHï¼ˆèª¬æ˜å¿…é ˆï¼‰**:
- è¢«ä¿é™ºè€…ã€è³¦èª²ã€é‚„ä»˜ã€æ‰€å¾—å‰²ã€å‡ç­‰å‰²ã€è³‡ç”£å‰²
- æˆ¸ç±è¬„æœ¬ã€æˆ¸ç±æŠ„æœ¬ã€è¢«æ‰¶é¤Šè€…ã€æ‹ å‡ºã€å……å½“ã€æ›´æ­£
- å‡¦åˆ†ã€ä¸æœç”³ç«‹ã¦ã€å¯©æŸ»è«‹æ±‚ã€èª²ç¨è¨¼æ˜æ›¸ã€éèª²ç¨è¨¼æ˜æ›¸
- æ‰€å¾—è¨¼æ˜æ›¸ã€æ¸›å…ã€çŒ¶äºˆã€ç£ä¿ƒ

**MEDIUMï¼ˆæ–‡è„ˆæ¬¡ç¬¬ï¼‰**:
- æ§é™¤ã€æ‰¶é¤Šã€æ»ç´ã€å°é‘‘è¨¼æ˜

**LOWï¼ˆèª¬æ˜ä¸è¦ï¼‰**:
- å±Šå‡ºäººã€ç”³è«‹è€…ã€å—çµ¦è€…ã€ä¸–å¸¯ä¸»ã€ç¶šæŸ„
- ä½æ°‘ç¥¨ã€å§”ä»»çŠ¶ã€æœ¬äººç¢ºèªæ›¸é¡ã€çµ¦ä»˜ã€æ±ºå®š

#### 2. ãƒ­ã‚¸ãƒƒã‚¯å¤‰æ›´
- `isTermRequiringExplanation()` é–¢æ•°ã‚’è¿½åŠ 
- `analyzeTerminology()` ã§HIGHãƒ¬ãƒ™ãƒ«ã®ç”¨èªã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯
- ç”¨èªèª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³è‡ªå‹•è¿½åŠ ã¯ã€HIGHãƒ¬ãƒ™ãƒ«ã®ç”¨èªãŒ2ã¤ä»¥ä¸Šã‚ã‚‹å ´åˆã®ã¿
- reviewãƒ¢ãƒ¼ãƒ‰ã§ç”¨èªè¡¨ç¤ºæ™‚ã«ãƒ¬ãƒ™ãƒ«ã‚’ã‚¢ã‚¤ã‚³ãƒ³ã§è¡¨ç¤ºï¼ˆğŸ”´HIGH/ğŸŸ¡MEDIUM/ğŸŸ¢LOWï¼‰

#### 3. æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
å…¨79ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†:
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‰Šé™¤: 36ä»¶ï¼ˆLOWãƒ¬ãƒ™ãƒ«ã®ç”¨èªã®ã¿ã ã£ãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
- ç”¨èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: 43ä»¶ï¼ˆHIGHãƒ¬ãƒ™ãƒ«ã®ç”¨èªã®ã¿ã‚’æ®‹ã™ï¼‰

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/scripts/auto-update-bot.ts` - ç”¨èªè¾æ›¸ã¨ãƒ­ã‚¸ãƒƒã‚¯æ›´æ–°
- `apps/web/data/artifacts/**/services/**/*.json` - ç”¨èªèª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ•´ç†

## Webæ¤œç´¢APIã®ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å¯¾å¿œ

### æ¦‚è¦
LLMæƒ…å ±å–å¾—ã‚·ã‚¹ãƒ†ãƒ ã®Webæ¤œç´¢ã«Brave Search APIã¨Google Custom Search APIã®ä¸¡æ–¹ã‚’ä½¿ç”¨å¯èƒ½ã«ã—ã€è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚

### èƒŒæ™¯ãƒ»æ¯”è¼ƒæ¤œè¨

| API | ç„¡æ–™æ  | æœ‰æ–™ä¾¡æ ¼ | æ—¥æœ¬èªå¯¾å¿œ |
|-----|--------|----------|------------|
| **Brave Search** | 2,000ã‚¯ã‚¨ãƒª/æœˆ | $5/1,000ã‚¯ã‚¨ãƒª | â—‹ è‰¯å¥½ |
| Google Custom Search | 100ã‚¯ã‚¨ãƒª/æ—¥ | $5/1,000ã‚¯ã‚¨ãƒª | â— æœ€è‰¯ |
| Serper | 2,500ã‚¯ã‚¨ãƒª/æœˆ | $1/1,000ã‚¯ã‚¨ãƒª | â—‹ éå…¬å¼ |
| Bing Search | âŒ çµ‚äº† | $35/1,000ã‚¯ã‚¨ãƒª | - |

**é¸å®šç†ç”±**: Brave Searchã‚’æ¨å¥¨ã¨ã—ã€Google Custom Searchã‚’ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦ä½µç”¨

### å¤‰æ›´å†…å®¹

#### 1. ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚µãƒãƒ¼ãƒˆ (`lib/llm/google-search.ts`)

**ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠãƒ­ã‚¸ãƒƒã‚¯**:
```typescript
// ç’°å¢ƒå¤‰æ•° SEARCH_PROVIDER ã§åˆ¶å¾¡
// 'brave' | 'google' | 'auto'ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: autoï¼‰
```

**ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‹•ä½œ**:
1. ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã§æ¤œç´¢å®Ÿè¡Œ
2. çµæœ0ä»¶ã®å ´åˆ â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã§å†æ¤œç´¢
3. ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿã®å ´åˆ â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã§å†æ¤œç´¢
4. ä¸¡æ–¹å¤±æ•— â†’ ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™

#### 2. æ–°è¦API

```typescript
// ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼çŠ¶æ…‹ç¢ºèª
getSearchProviderStatus(): SearchProviderStatus

// æ‹¡å¼µã•ã‚ŒãŸæ¤œç´¢ã‚ªãƒ—ã‚·ãƒ§ãƒ³
interface ExtendedSearchConfig {
  disableFallback?: boolean;  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç„¡åŠ¹åŒ–
  forceProvider?: SearchProvider;  // å¼·åˆ¶ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼æŒ‡å®š
}
```

#### 3. ç’°å¢ƒå¤‰æ•°

```bash
# Webæ¤œç´¢APIï¼ˆå°‘ãªãã¨ã‚‚1ã¤ã¯å¿…é ˆï¼‰
BRAVE_SEARCH_API_KEY=xxx          # æ¨å¥¨
GOOGLE_CUSTOM_SEARCH_API_KEY=xxx  # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨
GOOGLE_CUSTOM_SEARCH_ENGINE_ID=xxx

# ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
SEARCH_PROVIDER=auto  # 'brave' | 'google' | 'auto'
```

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/lib/llm/google-search.ts` - ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å®Ÿè£…
- `apps/web/lib/llm/brave-search.ts` - Brave Search API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- `apps/web/lib/llm/index.ts` - å‹ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ 
- `docs/LLM_FETCHER_SPEC.md` - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé¸æŠãƒ«ãƒ¼ãƒ«ã®æ‹¡å……ï¼ˆ32ç¨®é¡å¯¾å¿œï¼‰

### æ¦‚è¦
`content-structurer.ts`ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé¸æŠãƒ«ãƒ¼ãƒ«ã‚’`docs/FETCH_TO_SHOW_FLOWCHART.md`ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã¨åŒæœŸã—ã€32ç¨®é¡ã®DADSãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚¤ãƒ—ã«å®Œå…¨å¯¾å¿œã€‚

### å¤‰æ›´å†…å®¹

#### 1. COMPONENT_SELECTION_RULESã®æ‹¡å……
- 13ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰20+ã‚«ãƒ†ã‚´ãƒªã«æ‹¡å……
- æ–°è¦å¯¾å¿œãƒ–ãƒ­ãƒƒã‚¯:
  - **ãƒšãƒ¼ã‚¸æ§‹é€ **: Title, Summary, Breadcrumbs
  - **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: QuickLinks
  - **ã‚«ãƒ¼ãƒ‰**: CardGrid (media/link/info), InfoCard, InfoCardGrid
  - **ãƒˆãƒ”ãƒƒã‚¯ãƒ»ãƒ‹ãƒ¥ãƒ¼ã‚¹**: TopicGrid, TopicList, NewsList, NewsMeta
  - **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: TaskButton, Attachments
  - **åœ°åŒºãƒ»ç½å®³**: DistrictSelector, ShelterList, HazardMapViewer
  - **ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸**: Hero
  - **å‚ç…§**: Sources

#### 2. calloutå‚ç…§ã®å®Œå…¨å‰Šé™¤
- RichTextNodeã‹ã‚‰calloutå‹ã‚’å‰Šé™¤ï¼ˆå»ƒæ­¢æ¸ˆã¿ï¼‰
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå†…ã®calloutå‚ç…§ã‚’å‰Šé™¤
- ã€ŒRichText with calloutã€â†’ã€ŒRichText (unordered list)ã€ã«å¤‰æ›´

#### 3. buildEnhancedBlockPromptã¸ã®æ–°è¦ãƒ–ãƒ­ãƒƒã‚¯å®šç¾©è¿½åŠ 
- RelatedLinksï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªé–¢é€£ãƒªãƒ³ã‚¯ï¼‰
- ActionButtonï¼ˆä¸»è¦CTAãƒœã‚¿ãƒ³ï¼‰
- TaskButtonï¼ˆè£œåŠ©ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ï¼‰
- Attachmentsï¼ˆæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- CardGridï¼ˆã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ï¼‰
- InfoCardï¼ˆæƒ…å ±ã‚«ãƒ¼ãƒ‰ï¼‰
- InfoCardGridï¼ˆæƒ…å ±ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ï¼‰
- Sourcesï¼ˆå‡ºå…¸ãƒ»å‚ç…§å…ƒï¼‰

#### 4. ã‚»ã‚¯ã‚·ãƒ§ãƒ³é †åºã®æ›´æ–°
- ã€Œ11. é–¢é€£æƒ…å ±ã€ã« RelatedLinks ã‚’è¿½åŠ 
- ã€Œ12. é–¢é€£æ›¸é¡ (Attachments)ã€ã‚’è¿½åŠ 
- ã€Œ13. å‡ºå…¸ãƒ»å‚ç…§å…ƒ (Sources)ã€ã‚’è¿½åŠ 

#### 5. ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ï¼ˆ/dev/structureï¼‰ã®æ›´æ–°
- BlockPreviewã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è‰²åˆ†ã‘ã‚’32ç¨®é¡ã«å¯¾å¿œ
- ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«è‰²ã‚’çµ±ä¸€ï¼ˆãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã¨åŒæœŸï¼‰

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/lib/llm/prompts/content-structurer.ts` - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé¸æŠãƒ«ãƒ¼ãƒ«
- `apps/web/app/dev/structure/page.tsx` - ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸UI
- `docs/FETCH_TO_SHOW_FLOWCHART.md` - ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆï¼ˆå‚ç…§å…ƒï¼‰

## LLMãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ç°¡ç´ åŒ–

### æ¦‚è¦
LLMå‘¼ã³å‡ºã—æ™‚ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç°¡ç´ åŒ–ã—ã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã€‚å“è³ªã¯ç¶­æŒã—ã¤ã¤ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé•·ã‚’å¤§å¹…ã«å‰Šæ¸›ã€‚

### ãƒ†ã‚¹ãƒˆçµæœ

#### æ¤œç´¢ã‚¯ã‚¨ãƒªç”Ÿæˆ
| ãƒ†ã‚¹ãƒˆ | ç¾åœ¨(æ–‡å­—) | ç°¡æ½”ç‰ˆ(æ–‡å­—) | å‰Šæ¸›ç‡ |
|--------|-----------|-------------|--------|
| å›½æ°‘å¥åº·ä¿é™º | 234 | 75 | 68% |
| ä½æ°‘ç¥¨ã®å†™ã— | 224 | 65 | 71% |
| å…ç«¥æ‰‹å½“ | 222 | 63 | 72% |
| **å¹³å‡** | - | - | **70%** |

#### æƒ…å ±æŠ½å‡º
| ãƒ†ã‚¹ãƒˆ | ç¾åœ¨(æ–‡å­—) | ç°¡æ½”ç‰ˆ(æ–‡å­—) | å‰Šæ¸›ç‡ |
|--------|-----------|-------------|--------|
| å›½æ°‘å¥åº·ä¿é™º | 534 | 297 | 44% |
| ä½æ°‘ç¥¨ã®å†™ã— | 463 | 264 | 43% |
| ã‚´ãƒŸåé›† | 461 | 268 | 42% |
| **å¹³å‡** | - | - | **43%** |

### å¤‰æ›´å†…å®¹

#### 1. æ¤œç´¢ã‚¯ã‚¨ãƒªç”Ÿæˆ (`query-generator.ts`)

**å¤‰æ›´å‰**:
```
ã‚ãªãŸã¯æ—¥æœ¬ã®è‡ªæ²»ä½“ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚

ä»¥ä¸‹ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æœ€é©ãªGoogleæ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

è‡ªæ²»ä½“å: ${municipalityName}
ã‚µãƒ¼ãƒ“ã‚¹: ${serviceName}
å–å¾—ã—ãŸã„æƒ…å ±:
${targetInfo.map((info) => `- ${info}`).join('\n')}

è¦ä»¶:
- æ¤œç´¢ã‚¯ã‚¨ãƒªã¯1è¡Œã®ã¿å‡ºåŠ›
- å…¬å¼ã‚µã‚¤ãƒˆãŒè¦‹ã¤ã‹ã‚Šã‚„ã™ã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨
- ä¸€èˆ¬çš„ãªè¡¨ç¾ã‚’ä½¿ç”¨ï¼ˆå°‚é–€ç”¨èªã¯é¿ã‘ã‚‹ï¼‰
- ã€Œsite:ã€æŒ‡å®šã¯å«ã‚ãªã„

å‡ºåŠ›: æ¤œç´¢ã‚¯ã‚¨ãƒªã®ã¿ï¼ˆèª¬æ˜ä¸è¦ï¼‰
```

**å¤‰æ›´å¾Œ**:
```
${municipalityName} ${serviceName}ã®å…¬å¼æƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹ã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆã€‚
å–å¾—å¯¾è±¡: ${targetInfo.join(', ')}
å‡ºåŠ›: æ¤œç´¢ã‚¯ã‚¨ãƒªã®ã¿ï¼ˆ1è¡Œï¼‰
```

#### 2. æƒ…å ±æŠ½å‡º (`extractor.ts`)

**å¤‰æ›´å‰**:
```
ä»¥ä¸‹ã®Webãƒšãƒ¼ã‚¸ã‹ã‚‰ã€æŒ‡å®šã•ã‚ŒãŸæƒ…å ±ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚

ã€Webãƒšãƒ¼ã‚¸å†…å®¹ã€‘
${truncatedContent}

ã€æŠ½å‡ºã™ã‚‹æƒ…å ±ã€‘
${variableList}

ã€å‡ºåŠ›å½¢å¼ã€‘
JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
æƒ…å ±ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ null ã¨ã—ã¦ãã ã•ã„ã€‚
å€¤ã¯æ­£ç¢ºã«æŠ½å‡ºã—ã€ä½™åˆ†ãªèª¬æ˜ã¯å«ã‚ãªã„ã§ãã ã•ã„ã€‚

{
${variables.map((v) => `  "${v.variableName}": "å€¤ã¾ãŸã¯null"`).join(',\n')}
}
```

**å¤‰æ›´å¾Œ**:
```
ãƒšãƒ¼ã‚¸ã‹ã‚‰ä»¥ä¸‹ã‚’æŠ½å‡ºã—JSONå‡ºåŠ›ã€‚è¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã°nullã€‚
${variableList}

ãƒšãƒ¼ã‚¸:
${truncatedContent}
```

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/lib/llm/prompts/query-generator.ts` - æ¤œç´¢ã‚¯ã‚¨ãƒªç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
- `apps/web/lib/llm/prompts/extractor.ts` - æƒ…å ±æŠ½å‡ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
- `apps/web/scripts/test-prompt-comparison.ts` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¯”è¼ƒãƒ†ã‚¹ãƒˆ
